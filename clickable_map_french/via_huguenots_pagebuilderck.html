<!-- CODE POUR PAGE BUILDER CK - VIA HUGUENOTS -->

<!-- ÉTAPE 1: Ajouter ce CSS dans un module "Custom HTML" ou dans votre template -->
<style>
    .via-map-container {
        position: relative;
        width: 100%;
        max-width: 1170px;
        margin: 0 auto;
    }

    .via-map-container img {
        width: 100%;
        height: auto;
        display: block;
        opacity:0.7;
    }

    .via-map-container svg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
    }

    .via-stage-marker {
        pointer-events: all;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    /* Type-specific colors with transparency */
    .via-stage-marker.stage circle {
        fill: #ff6b6b;
        stroke: white;
        stroke-width: 2;
        opacity: 0.8;
    }

    .via-stage-marker.alternative circle {
        fill: #FF9800;
        stroke: white;
        stroke-width: 2;
        opacity: 0.8;
    }

    .via-stage-marker.urban circle {
        fill: #2196F3;
        stroke: white;
        stroke-width: 2;
        opacity: 0.8;
    }

    .via-stage-marker.special circle {
        fill: #9C27B0;
        stroke: white;
        stroke-width: 2;
        opacity: 0.8;
    }

    .via-stage-marker.regional rect {
        fill: #4CAF50;
        stroke: white;
        stroke-width: 2;
        opacity: 0.8;
    }

    .via-stage-marker:hover circle,
    .via-stage-marker:hover rect {
        opacity: 1;
    }

    .via-stage-marker text {
        fill: white;
        font-size: 10px;
        font-weight: bold;
        text-anchor: middle;
        dominant-baseline: middle;
        pointer-events: none;
    }

    .via-connection-line {
        stroke-width: 2;
        opacity: 0.5;
        pointer-events: none;
    }

    .via-tooltip {
        position: fixed;
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 10px 15px;
        border-radius: 4px;
        font-size: 14px;
        pointer-events: none;
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: 1000;
        max-width: 300px;
        white-space: nowrap;
    }

    .via-tooltip.show {
        opacity: 1;
    }

    .via-tooltip .stage-name {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
    }

    .via-tooltip .stage-name.stage {
        color: #ff6b6b;
    }

    .via-tooltip .stage-name.alternative {
        color: #FF9800;
    }

    .via-tooltip .stage-name.urban {
        color: #2196F3;
    }

    .via-tooltip .stage-name.special {
        color: #9C27B0;
    }

    .via-tooltip .stage-name.regional {
        color: #4CAF50;
    }

    .via-tooltip .stage-distance {
        font-size: 12px;
        color: #ccc;
    }

    .via-legend {
        margin-top: 15px;
        padding: 10px;
        background: #f9f9f9;
        border-radius: 4px;
        font-size: 13px;
    }

    .via-legend-title {
        font-weight: bold;
        margin-bottom: 8px;
        color: #333;
    }

    .via-legend-item {
        display: inline-flex;
        align-items: center;
        margin-right: 15px;
        margin-bottom: 5px;
    }

    .via-legend-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 5px;
        opacity: 0.7;
    }

    .via-legend-rect {
        width: 16px;
        height: 10px;
        margin-right: 5px;
        opacity: 0.7;
    }

    .via-legend-stage {
        background: #ff6b6b;
    }

    .via-legend-alternative {
        background: #FF9800;
    }

    .via-legend-urban {
        background: #2196F3;
    }

    .via-legend-special {
        background: #9C27B0;
    }

    .via-legend-regional {
        background: #4CAF50;
    }

    @media (max-width: 768px) {
        .via-stage-marker text {
            font-size: 8px;
        }
        .via-tooltip {
            font-size: 12px;
            padding: 8px 12px;
        }
        .via-legend {
            font-size: 11px;
        }
        .via-legend-item {
            display: block;
            margin-bottom: 8px;
        }
    }
</style>

<!-- ÉTAPE 2: Ajouter ce HTML dans Page Builder CK -->
<div class="via-map-container" id="viaMapContainer">
    <img src="files/clickable_map/map_chemin_layer.jpg" alt="Carte Via Huguenots" id="viaMapImage">
    <svg id="viaMapSvg" viewBox="0 0 1170 705" preserveAspectRatio="xMidYMid meet">
        <!-- Les marqueurs seront ajoutés par JavaScript -->
    </svg>
</div>

<div class="via-tooltip" id="viaTooltip">
    <span class="stage-name"></span>
    <span class="stage-distance"></span>
</div>

<div class="via-legend">
    <div class="via-legend-title">Légende:</div>
    <div class="via-legend-item">
        <div class="via-legend-dot via-legend-stage"></div>
        <span>Étapes</span>
    </div>
    <div class="via-legend-item">
        <div class="via-legend-dot via-legend-alternative"></div>
        <span>Alternatives</span>
    </div>
    <div class="via-legend-item">
        <div class="via-legend-dot via-legend-urban"></div>
        <span>Urbains</span>
    </div>
    <div class="via-legend-item">
        <div class="via-legend-dot via-legend-special"></div>
        <span>Spéciaux</span>
    </div>
    <div class="via-legend-item">
        <div class="via-legend-rect via-legend-regional"></div>
        <span>Régionaux</span>
    </div>
</div>

<!-- ÉTAPE 3: Charger le script JavaScript externe -->
<script src="files/clickable_map/via_huguenots_map.js"></script>

<!--
INSTRUCTIONS D'INSTALLATION DANS JOOMLA / PAGE BUILDER CK:

1. Uploadez les fichiers suivants sur votre serveur Joomla dans le dossier files/clickable_map/:
   - files/clickable_map/map_chemin_layer.jpg (image de la carte)
   - files/clickable_map/via_huguenots_merged.json (données JSON)
   - files/clickable_map/via_huguenots_map.js (script JavaScript)

   Note: Le dossier files/ est accessible publiquement dans Joomla, contrairement aux
   dossiers à la racine.

2. Dans Page Builder CK, créez un nouveau module "Custom HTML"

3. Copiez-collez le CSS (ÉTAPE 1) dans la section "Head" de votre template ou dans un module

4. Copiez-collez le HTML (ÉTAPE 2) dans le module Page Builder CK

5. Ajoutez la balise script (ÉTAPE 3) à la fin de votre page:
   <script src="files/clickable_map/via_huguenots_map.js"></script>

   Note: Le JavaScript est maintenant dans un fichier séparé pour éviter les problèmes
   de reformatage automatique dans Page Builder CK.

6. Les chemins sont configurés pour Joomla:
   - Image: src="files/clickable_map/map_chemin_layer.jpg"
   - JSON: 'files/clickable_map/via_huguenots_merged.json' (dans via_huguenots_map.js)
   - Script: src="files/clickable_map/via_huguenots_map.js"

7. Testez en prévisualisant la page

STRUCTURE DES DONNÉES:
Le fichier JSON contient désormais 38 entrées (28 étapes + 10 variantes):
- Étapes principales (type: "stage"): 1-28
- Itinéraires alternatifs (type: "alternative"): 01bis, 05bis, 12bis
- Parcours urbains (type: "urban"): 02bis, 05bis2, 15bis, 25bis, 28bis
- Spécial (type: "special"): 16bis (Visioguide)
- Régional (type: "regional"): Routes régionales

PERSONNALISATION:
- Couleurs des points : modifier les valeurs dans le CSS (typeColors)
- Taille des points : modifier la valeur 'r' dans le JavaScript (ligne avec setAttribute('r', '10'))
- Taille des boutons régionaux : modifier width/height du rect
- Style du tooltip : modifier .via-tooltip dans le CSS
- Opacité : modifier opacity dans le CSS (actuellement 0.5)
-->
